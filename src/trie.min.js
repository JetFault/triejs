/**
* Copyright (C) 2011 Paul Thurlow
*
* Permission is hereby granted, free of charge, to any person obtaining a copy 
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
if(typeof exports==="undefined"){var exports={}}(function(b){var a=function(d){this.options={maxCache:10,insert:null,sort:null,clip:null,copy:null};this.root={};for(var c in d){if(d.hasOwnProperty(c)){this.options[c]=d[c]}}if(typeof this.options.insert!="function"){this.options.insert=function(f,e){if(f.length){f.push(e)}else{f=[e]}return f}}if(typeof this.options.sort!="function"){this.options.sort=function(){}}if(typeof this.options.clip!="function"){this.options.clip=function(e){if(this.length>e){this.splice(0,this.length-e)}}}if(typeof this.options.copy!="function"){this.options.copy=function(e){return e.slice(0)}}};a.prototype={_addCacheData:function(d,c){if(d==this.root){return}if(!d.data){d.data={}}d.data=this.options.insert.call(this,d.data,c);this.options.sort.call(d.data);this.options.clip.call(d.data,this.options.maxCache)},_addSuffix:function(h,f,g){var e=h.charAt(0),c=h.substring(1)||null,d={data:{}};if(c){d.suffix=c}g[e]=d;g[e].data=this.options.insert.call(this,g[e].data,f)},_moveSuffix:function(h,f,g){var e=h.charAt(0),c=h.substring(1)||null,d={data:{}};if(c){d.suffix=c}g[e]=d;g[e].data=this.options.copy(f)},addWord:function(h,f){if(typeof h!="string"){return false}h=h.toLowerCase();var g=this.root;for(var c=0,d=h.length;c<d;c++){var e=h.charAt(c);if(!g[e]){if(g.suffix){this._moveSuffix(g.suffix,g.data,g);delete g.suffix}if(!g[e]){this._addSuffix(h.substring(c),f,g);this._addCacheData(g,f);break}this._addCacheData(g,f);if(c==d-1){if(g[e].suffix){this._moveSuffix(g[e].suffix,g[e].data,g[e]);delete g[e].suffix}this._addCacheData(g[e],f)}g=g[e]}else{if(c==d-1){this._addCacheData(g,f);this._addCacheData(g[e],f)}else{this._addCacheData(g,f);g=g[e]}}}},getPrefix:function(f){if(typeof f!=="string"){return undefined}f=f.toLowerCase();var g=this.root;for(var c=0,d=f.length;c<d;c++){var e=f.charAt(c);if(!g[e]){if(g.suffix&&g.suffix.indexOf(f.substring(c))==0){return g.data}else{return undefined}}else{g=g[e]}}return g.data},getSubtree:function(g){var d=[],f=[g],e;while(e=f.pop()){for(var c in e){if(e.hasOwnProperty(c)){if(c=="data"){d.push(e.data)}else{if(c!="suffix"){f.push(e[c])}}}}}return d}};b.Triejs=a})(exports);